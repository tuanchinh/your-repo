<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ğŸ“¥ GiÃ¡o viÃªn â€“ Danh sÃ¡ch bÃ i ná»™p</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f9;
  margin:0;
  padding:20px;
}
h2{
  text-align:center;
  color:#2c3e50;
}
button{
  padding:10px 16px;
  background:#3498db;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
button:hover{background:#2980b9}

.card{
  background:#fff;
  padding:15px;
  margin:10px auto;
  max-width:900px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

.student{
  font-weight:bold;
  color:#2c3e50;
}
.meta{
  color:#555;
  font-size:14px;
}
a{
  text-decoration:none;
  color:#2980b9;
}
a:hover{text-decoration:underline}
.error{
  color:red;
  text-align:center;
}
</style>
</head>

<body>

<h2>ğŸ“¥ Danh sÃ¡ch bÃ i ná»™p cá»§a há»c sinh</h2>

<div style="text-align:center">
  <button id="loadSubmissions">ğŸ”„ Táº£i danh sÃ¡ch</button>
</div>

<div id="list" style="margin-top:20px;"></div>

<script>
document.getElementById("loadSubmissions").addEventListener("click", loadSubmissions);

async function loadSubmissions(){
  const listDiv = document.getElementById("list");
  listDiv.innerHTML = "â³ Äang táº£i dá»¯ liá»‡u...";

  try {
    // KHÃ”NG ghi cá»©ng localhost â†’ dÃ¹ng cÃ¹ng domain vá»›i server
    const res = await fetch("/submissions.json");
    if (!res.ok) throw new Error("KhÃ´ng tÃ¬m tháº¥y submissions.json");

    const submissions = await res.json();

    if (!Array.isArray(submissions) || submissions.length === 0) {
      listDiv.innerHTML = "<p class='error'>âš ï¸ ChÆ°a cÃ³ bÃ i ná»™p nÃ o.</p>";
      return;
    }

    listDiv.innerHTML = "";

    submissions.forEach((sub, index) => {

      const student = sub.student || "KhÃ´ng rÃµ tÃªn";
      const className = sub.class || "â€”";
      const examCode = sub.examCode || "â€”";
      const score = sub.score !== undefined ? sub.score : "ChÆ°a cháº¥m";
      const date = sub.date || new Date().toISOString().split("T")[0];

      // File PDF (náº¿u cÃ³)
      let pdfLink = "";
      if (sub.pdfFile) {
        pdfLink = `
          <a href="/submissions/${sub.pdfFile}" target="_blank">
            ğŸ“„ Xem / táº£i bÃ i lÃ m (PDF)
          </a>
        `;
      } else {
        pdfLink = `<span style="color:#999">KhÃ´ng cÃ³ file PDF</span>`;
      }

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="student">ğŸ‘©â€ğŸ“ ${student}</div>
        <div class="meta">
          Lá»›p: ${className} | MÃ£ Ä‘á»: ${examCode} <br>
          NgÃ y ná»™p: ${date} | Äiá»ƒm: <strong>${score}</strong>
        </div>
        <div style="margin-top:8px">${pdfLink}</div>
      `;

      listDiv.appendChild(card);
    });

  } catch (err) {
    console.error(err);
    listDiv.innerHTML =
      "<p class='error'>âŒ Lá»—i khi táº£i danh sÃ¡ch bÃ i ná»™p. Kiá»ƒm tra server.</p>";
  }
}
</script>

</body>
</html>