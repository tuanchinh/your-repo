<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gi√°o vi√™n ‚Äì Xem b√†i n·ªôp</title>
<style>
body{font-family:"Segoe UI",sans-serif;margin:20px;background:#eef3f7;}
h1{text-align:center;color:#0a4a8e;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{border:1px solid #ccc;padding:8px;text-align:center;}
th{background:#3498db;color:#fff;}
tr:nth-child(even){background:#f9f9f9;}
button{padding:6px 12px;border:none;border-radius:4px;background:#0b74d1;color:#fff;cursor:pointer;}
button:hover{background:#095ba8;}
</style>
</head>
<body>

<h1>üìÑ Xem b√†i n·ªôp</h1>

<table>
<thead>
<tr>
<th>H·ªçc sinh</th>
<th>L·ªõp</th>
<th>ƒê·ªÅ</th>
<th>Ng√†y n·ªôp</th>
<th>File</th>
</tr>
</thead>
<tbody id="submissionBody">
<tr><td colspan="5">ƒêang t·∫£i d·ªØ li·ªáu...</td></tr>
</tbody>
</table>

<script>
if(localStorage.getItem("role")!=="teacher"){ alert("B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p!"); window.location.href="index.html"; }

async function loadSubmissions(){
    const tbody = document.getElementById("submissionBody");
    try{
        const res = await fetch("/submissions");
        const subs = await res.json();
        if(subs.length===0){ tbody.innerHTML=`<tr><td colspan="5">Ch∆∞a c√≥ b√†i n·ªôp n√†o</td></tr>`; return; }
        tbody.innerHTML="";
        subs.forEach(s=>{
            tbody.innerHTML+=`
                <tr>
                    <td>${s.student}</td>
                    <td>${s.class}</td>
                    <td>${s.examId}</td>
                    <td>${s.submittedAt}</td>
                    <td><a href="/uploads/${s.file}" download><button>üìÑ T·∫£i</button></a></td>
                </tr>
            `;
        });
    }catch(err){
        console.error(err);
        tbody.innerHTML=`<tr><td colspan="5">‚ùå L·ªói t·∫£i d·ªØ li·ªáu</td></tr>`;
    }
}

loadSubmissions();
</script>

</body>
</html>