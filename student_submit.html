<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>N·ªôp b√†i l√†m h·ªçc sinh</title>
</head>
<body>
  <h2>N·ªôp b√†i l√†m</h2>
  <form id="submitForm">
    <div>
      <label>H·ªç t√™n h·ªçc sinh:</label><br />
      <input type="text" id="student" required />
    </div>
    <div style="margin-top:10px;">
      <label>B√†i l√†m:</label><br />
      <textarea id="answers" rows="6" cols="50" required></textarea>
    </div>
    <div style="margin-top:10px;">
      <button type="submit">N·ªôp b√†i</button>
    </div>
  </form>

  <div id="result" style="margin-top:20px;"></div>

  <script>
    document.getElementById("submitForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const student = document.getElementById("student").value;
      const answers = document.getElementById("answers").value;

      const submission = {
        student: student,
        answers: answers.split("\n"), // m·ªói d√≤ng l√† m·ªôt c√¢u tr·∫£ l·ªùi
        date: new Date().toISOString().split("T")[0]
      };

      try {
        const res = await fetch("http://localhost:3000/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(submission)
        });

        const data = await res.json();
        if (data.status === "ok") {
          document.getElementById("result").innerHTML = `
            <p>B√†i l√†m ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh PDF:</p>
            <a href="http://localhost:3000${data.pdfLink}" target="_blank">üìÑ T·∫£i PDF t·∫°i ƒë√¢y</a>
          `;
        } else {
          document.getElementById("result").innerText = "C√≥ l·ªói khi n·ªôp b√†i.";
        }
      } catch (err) {
        console.error(err);
        document.getElementById("result").innerText = "Kh√¥ng th·ªÉ k·∫øt n·ªëi server.";
      }
    });
  </script>
</body>
</html>