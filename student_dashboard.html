<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ğŸ“ Trang há»c sinh</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    font-family:Segoe UI, sans-serif;
    background:#f2f6fb;
    margin:0;
}
.wrap{
    max-width:1000px;
    margin:25px auto;
    background:#fff;
    padding:25px;
    border-radius:14px;
    box-shadow:0 6px 18px rgba(0,0,0,0.18);
}
h1{text-align:center;color:#0a4a8e}
h2{color:#0b74d1;margin-top:30px}

.card{
    background:#f9fbfd;
    padding:16px;
    margin-top:15px;
    border-radius:10px;
    border-left:5px solid #0b74d1;
}
.deadline{color:#d32f2f;font-weight:600}
button{
    background:#0b74d1;
    color:#fff;
    padding:10px 18px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    margin-top:10px;
}
button:hover{background:#095ba8}
.logout{
    background:#888;
}
.logout:hover{background:#666}
small{color:#555}
.empty{
    padding:12px;
    background:#eee;
    border-radius:8px;
    margin-top:12px;
}
</style>
</head>

<body>

<div class="wrap">

<button class="logout" onclick="logout()">ğŸšª ÄÄƒng xuáº¥t</button>

<h1>ğŸ“ TRANG Há»ŒC SINH</h1>

<p>
ğŸ‘©â€ğŸ“ <b>Há»c sinh:</b> <span id="studentName"></span><br>
ğŸ« <b>Lá»›p:</b> <span id="studentClass"></span>
</p>

<!-- ================== BÃ€I KIá»‚M TRA ================== -->
<h2>ğŸ“ BÃ i kiá»ƒm tra Ä‘Æ°á»£c giao</h2>
<div id="examList"></div>

<!-- ================== Há»ŒC LIá»†U ================== -->
<h2>ğŸ“š Há»c liá»‡u giÃ¡o viÃªn gá»­i</h2>
<div id="materialList"></div>

</div>

<script>
// ================== KIá»‚M TRA ÄÄ‚NG NHáº¬P ==================
const role = localStorage.getItem("role");
if(role !== "student"){
    alert("Báº¡n chÆ°a Ä‘Äƒng nháº­p!");
    location.href="login.html";
}

const studentName = localStorage.getItem("studentName") || "Há»c sinh";
const studentClass = localStorage.getItem("studentClass");

document.getElementById("studentName").innerText = studentName;
document.getElementById("studentClass").innerText = studentClass;

// ================== LOAD BÃ€I KIá»‚M TRA ==================
function loadExams(){
    const box=document.getElementById("examList");
    const exams=JSON.parse(localStorage.getItem("assigned_exams")||"[]");

    const filtered=exams.filter(e=>e.className===studentClass && e.active);

    if(filtered.length===0){
        box.innerHTML="<div class='empty'>ğŸ“­ Hiá»‡n chÆ°a cÃ³ bÃ i kiá»ƒm tra</div>";
        return;
    }

    box.innerHTML="";
    filtered.forEach(e=>{
        const div=document.createElement("div");
        div.className="card";
        div.innerHTML=`
            <b>ğŸ“„ Äá»:</b> ${e.examFile}<br>
            <span class="deadline">â° Háº¡n ná»™p: ${e.deadline}</span><br>
            <small>ğŸ‘¨â€ğŸ« GV: ${e.teacher} | ğŸ“… Giao: ${e.assignedAt}</small><br>
            <button onclick="startExam('${e.examFile}')">âœï¸ LÃ m bÃ i</button>
        `;
        box.appendChild(div);
    });
}

// ================== LOAD Há»ŒC LIá»†U ==================
function loadMaterials(){
    const box=document.getElementById("materialList");
    const materials=JSON.parse(localStorage.getItem("learning_materials")||"[]");

    const filtered=materials.filter(m=>m.className===studentClass);

    if(filtered.length===0){
        box.innerHTML="<div class='empty'>ğŸ“­ ChÆ°a cÃ³ há»c liá»‡u</div>";
        return;
    }

    box.innerHTML="";
    filtered.forEach(m=>{
        const div=document.createElement("div");
        div.className="card";
        div.innerHTML=`
            <b>ğŸ“˜ ${m.title}</b><br>
            <a href="${m.link}" target="_blank">ğŸ”— Má»Ÿ há»c liá»‡u</a><br>
            <small>${m.note || ""}</small><br>
            <small>ğŸ‘¨â€ğŸ« ${m.teacher} | ğŸ“… ${m.sentAt}</small>
        `;
        box.appendChild(div);
    });
}

// ================== LÃ€M BÃ€I (OFFLINE) ==================
function startExam(file){
    localStorage.setItem("current_exam", file);
    location.href="student_exam.html";
}

// ================== ÄÄ‚NG XUáº¤T ==================
function logout(){
    localStorage.clear();
    location.href="login.html";
}

// ================== INIT ==================
loadExams();
loadMaterials();
</script>

</body>
</html>